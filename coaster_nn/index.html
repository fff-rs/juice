<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Provides a Coaster Plugin, to extend Coaster with Neural Network related operations such as convolutions, pooling, ReLU, etc. A full list of operations provided by this Plugin, can be found at the provided Operations section."><title>coaster_nn - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-5bc39a1768837dd0.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="coaster_nn" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.2 (25ef9e3d8 2024-04-09)" data-channel="1.77.2" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-4c98445ec4002617.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../coaster_nn/index.html">coaster_nn</a><span class="version">0.5.0</span></h2></div><div class="sidebar-elems"><ul class="block">
            <li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../coaster_nn/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">coaster_nn</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/coaster_nn/lib.rs.html#1-132">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Provides a <a href="https://github.com/spearow/coaster">Coaster</a> Plugin, to extend Coaster with Neural Network related
operations such as convolutions, pooling, ReLU, etc. A full list of operations provided by this Plugin,
can be found at the <a href="#operations">provided Operations section</a>.</p>
<h3 id="overview"><a class="doc-anchor" href="#overview">§</a>Overview</h3>
<p>This Coaster Plugin extends Coaster’s Backend with NN related methods/operations. This allows
you to run these operations (and therefore your application) on your local machine as well as on servers,
mobiles or any other machine (as if they were written for common CPU execution), while
receiving the significant performance increases (usually one-to-two orders of magnitutde), by
executing the operations on special purpose hardware such as GPUs - if they are available. Usage examples
can be found in the next section.</p>
<p>The architecture of a Plugin is quite easy. It defines one Plugin Trait, in this case the <code>NN</code>
trait, which implements basic functionality for initialization and multiple Plugin Operation Traits which define the
methods which are going to be available on the Backend, as the Plugin Trait as well as the Plugin Operations Traits
are implemented for the Coaster Backends (CUDA, OpenCL, Native). The operations take as arguments one or many
SharedTensors, holding the data over which the operation should happen, and none or one Operation Configuration.</p>
<h3 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h3>
<p>An example on how to write some data into a SharedTensor and compute the result of the
sigmoid function for each value:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">extern crate </span>coaster <span class="kw">as </span>co;
<span class="kw">extern crate </span>coaster_nn <span class="kw">as </span>nn;
<span class="kw">use </span>co::prelude::<span class="kw-2">*</span>;
<span class="kw">use </span>co::frameworks::native::flatbox::FlatBox;
<span class="kw">use </span>nn::<span class="kw-2">*</span>;

<span class="kw">fn </span>write_to_memory&lt;T: Copy&gt;(mem: <span class="kw-2">&amp;mut </span>FlatBox, data: <span class="kw-2">&amp;</span>[T]) {
    <span class="kw">let </span><span class="kw-2">mut </span>mem_buffer = mem.as_mut_slice::&lt;T&gt;();
    <span class="kw">for </span>(index, datum) <span class="kw">in </span>data.iter().enumerate() {
        mem_buffer[index] = <span class="kw-2">*</span>datum;
    }
}

<span class="kw">use </span><span class="kw">crate</span>::co::frameworks::cuda::get_cuda_backend;
<span class="kw">pub fn </span>main() {
    <span class="comment">// Initialize a CUDA Backend.
    // Usually you would not use CUDA but let Coaster pick what is available on the machine.
    </span><span class="kw">let </span>backend = get_cuda_backend();

    <span class="comment">// Initialize two SharedTensors.
    </span><span class="kw">let </span><span class="kw-2">mut </span>x = SharedTensor::&lt;f32&gt;::new(<span class="kw-2">&amp;</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>));
    <span class="kw">let </span><span class="kw-2">mut </span>result = SharedTensor::&lt;f32&gt;::new(<span class="kw-2">&amp;</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>));
    <span class="comment">// Fill `x` with some data.
    </span><span class="kw">let </span>payload: <span class="kw-2">&amp;</span>[f32] = <span class="kw-2">&amp;</span>::std::iter::repeat(<span class="number">1f32</span>).take(x.capacity()).collect::&lt;Vec&lt;f32&gt;&gt;();
    <span class="kw">let </span>native = Native::new();
    <span class="kw">let </span>cpu = native.new_device(native.hardwares()).unwrap();
    write_to_memory(x.write_only(<span class="kw-2">&amp;</span>cpu).unwrap(), payload); <span class="comment">// Write to native host memory.
    // Run the sigmoid operation, provided by the NN Plugin, on your CUDA enabled GPU.
    </span>backend.sigmoid(<span class="kw-2">&amp;mut </span>x, <span class="kw-2">&amp;mut </span>result).unwrap();
    <span class="comment">// See the result.
    </span><span class="macro">println!</span>(<span class="string">"{:?}"</span>, result.read(<span class="kw-2">&amp;</span>cpu).unwrap().as_slice::&lt;f32&gt;());
}</code></pre></div>
<h3 id="provided-operations"><a class="doc-anchor" href="#provided-operations">§</a>Provided Operations</h3>
<p>This Plugins provides the following operations. If not denoted otherwise, this means forward and backward.
A <code>-</code> means not yet implemented.</p>
<div><table><thead><tr><th>Operation</th><th>CUDA</th><th>OpenCL</th><th>Native</th></tr></thead><tbody>
<tr><td>Sigmoid</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>SigmoidPointwise</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>ReLU</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>ReLUPointwise</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>Tanh</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>TanhPointwise</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Normalization (LRN)</td><td>cuDNN v5 or later</td><td>-</td><td>-</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Dropout</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Convolution</td><td>cuDNN v5 or later</td><td>-</td><td>Rust(fwd)</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Softmax</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>LogSoftmax</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Pooling Max</td><td>cuDNN v5 or later</td><td>-</td><td>Rust(fwd)</td></tr>
<tr><td>Pooling Avg</td><td>cuDNN v5 or later</td><td>-</td><td>-</td></tr>
</tbody></table>
</div></div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="frameworks/index.html" title="mod coaster_nn::frameworks">frameworks</a></div><div class="desc docblock-short">Provides the specific Framework implementations for the Library Operations.</div></li></ul><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.impl_ops_log_softmax_for.html" title="macro coaster_nn::impl_ops_log_softmax_for">impl_ops_log_softmax_for</a></div><div class="desc docblock-short">log softmax impl generation macro</div></li><li><div class="item-name"><a class="macro" href="macro.impl_ops_lrn_for.html" title="macro coaster_nn::impl_ops_lrn_for">impl_ops_lrn_for</a></div><div class="desc docblock-short">lrn impl generation macro
TODO it’s all unimplemented!() right now</div></li><li><div class="item-name"><a class="macro" href="macro.impl_ops_relu_for.html" title="macro coaster_nn::impl_ops_relu_for">impl_ops_relu_for</a></div><div class="desc docblock-short">relu impl generation macro</div></li><li><div class="item-name"><a class="macro" href="macro.impl_ops_sigmoid_for.html" title="macro coaster_nn::impl_ops_sigmoid_for">impl_ops_sigmoid_for</a></div><div class="desc docblock-short">sigmoid impl generation macro</div></li><li><div class="item-name"><a class="macro" href="macro.impl_ops_softmax_for.html" title="macro coaster_nn::impl_ops_softmax_for">impl_ops_softmax_for</a></div><div class="desc docblock-short">softmax impl generation macro</div></li><li><div class="item-name"><a class="macro" href="macro.impl_ops_tanh_for.html" title="macro coaster_nn::impl_ops_tanh_for">impl_ops_tanh_for</a></div><div class="desc docblock-short">tanh impl generation macro</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.ConvBackwardDataAlgo.html" title="enum coaster_nn::ConvBackwardDataAlgo">ConvBackwardDataAlgo</a></div><div class="desc docblock-short">Different algorithms to compute the gradient with respect to the filter.</div></li><li><div class="item-name"><a class="enum" href="enum.ConvBackwardFilterAlgo.html" title="enum coaster_nn::ConvBackwardFilterAlgo">ConvBackwardFilterAlgo</a></div><div class="desc docblock-short">Different algorithms to compute the gradient with respect to the filter.</div></li><li><div class="item-name"><a class="enum" href="enum.ConvForwardAlgo.html" title="enum coaster_nn::ConvForwardAlgo">ConvForwardAlgo</a></div><div class="desc docblock-short">Different algorithms to compute the convolution forward algorithm.</div></li><li><div class="item-name"><a class="enum" href="enum.DirectionMode.html" title="enum coaster_nn::DirectionMode">DirectionMode</a></div><div class="desc docblock-short">Direction Mode for RNN [cudnnDirectionMode_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnDirectionMode_t</div></li><li><div class="item-name"><a class="enum" href="enum.MathType.html" title="enum coaster_nn::MathType">MathType</a></div><div class="desc docblock-short">Indicate if Tensor Core Operations are permitted [cudnnMathType_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnMathType_t</div></li><li><div class="item-name"><a class="enum" href="enum.RnnAlgorithm.html" title="enum coaster_nn::RnnAlgorithm">RnnAlgorithm</a></div><div class="desc docblock-short">Algorithm for RNN [cudnnRNNAlgo_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnRNNAlgo_t</div></li><li><div class="item-name"><a class="enum" href="enum.RnnInputMode.html" title="enum coaster_nn::RnnInputMode">RnnInputMode</a></div><div class="desc docblock-short">Input Modes for RNN [cudnnRNNInputMode_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnRNNInputMode_t</div></li><li><div class="item-name"><a class="enum" href="enum.RnnNetworkMode.html" title="enum coaster_nn::RnnNetworkMode">RnnNetworkMode</a></div><div class="desc docblock-short">Network Type for RNN Networks [cudnnRNNMOde_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnRNNMode_t</div></li><li><div class="item-name"><a class="enum" href="enum.RnnPaddingMode.html" title="enum coaster_nn::RnnPaddingMode">RnnPaddingMode</a></div><div class="desc docblock-short">Enables/Disables the padded input/output [cudnnRNNPaddingMode_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnRNNPaddingMode_t</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.Convolution.html" title="trait coaster_nn::Convolution">Convolution</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support Convolution operations.</div></li><li><div class="item-name"><a class="trait" href="trait.ConvolutionConfig.html" title="trait coaster_nn::ConvolutionConfig">ConvolutionConfig</a></div><div class="desc docblock-short">Provides Convolution Config functionality.</div></li><li><div class="item-name"><a class="trait" href="trait.Dropout.html" title="trait coaster_nn::Dropout">Dropout</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support Dropout operations.</div></li><li><div class="item-name"><a class="trait" href="trait.LRN.html" title="trait coaster_nn::LRN">LRN</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support Local Response Normalization operations.</div></li><li><div class="item-name"><a class="trait" href="trait.LogSoftmax.html" title="trait coaster_nn::LogSoftmax">LogSoftmax</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support LogSoftmax operations.</div></li><li><div class="item-name"><a class="trait" href="trait.NN.html" title="trait coaster_nn::NN">NN</a></div><div class="desc docblock-short">Provides the functionality for a backend to support Neural Network related operations.</div></li><li><div class="item-name"><a class="trait" href="trait.NNOperationConfig.html" title="trait coaster_nn::NNOperationConfig">NNOperationConfig</a></div><div class="desc docblock-short">Provides generic NN Operation Config functionality.</div></li><li><div class="item-name"><a class="trait" href="trait.Pooling.html" title="trait coaster_nn::Pooling">Pooling</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support Pooling operations.</div></li><li><div class="item-name"><a class="trait" href="trait.Relu.html" title="trait coaster_nn::Relu">Relu</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support ReLU operations.</div></li><li><div class="item-name"><a class="trait" href="trait.ReluPointwise.html" title="trait coaster_nn::ReluPointwise">ReluPointwise</a></div><div class="desc docblock-short">Provides the functionality for pointwise ReLU operations (overwrites the input with the result of the operation).</div></li><li><div class="item-name"><a class="trait" href="trait.Rnn.html" title="trait coaster_nn::Rnn">Rnn</a></div><div class="desc docblock-short">Provide the functionality for a Backend to support RNN operations</div></li><li><div class="item-name"><a class="trait" href="trait.RnnConfig.html" title="trait coaster_nn::RnnConfig">RnnConfig</a></div><div class="desc docblock-short">Provides Rnn Config functionality.</div></li><li><div class="item-name"><a class="trait" href="trait.Sigmoid.html" title="trait coaster_nn::Sigmoid">Sigmoid</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support Sigmoid operations.</div></li><li><div class="item-name"><a class="trait" href="trait.SigmoidPointwise.html" title="trait coaster_nn::SigmoidPointwise">SigmoidPointwise</a></div><div class="desc docblock-short">Provides the functionality for pointwise Sigmoid operations (overwrites the input with the result of the operation).</div></li><li><div class="item-name"><a class="trait" href="trait.Softmax.html" title="trait coaster_nn::Softmax">Softmax</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support Softmax operations.</div></li><li><div class="item-name"><a class="trait" href="trait.Tanh.html" title="trait coaster_nn::Tanh">Tanh</a></div><div class="desc docblock-short">Provides the functionality for a Backend to support TanH operations.</div></li><li><div class="item-name"><a class="trait" href="trait.TanhPointwise.html" title="trait coaster_nn::TanhPointwise">TanhPointwise</a></div><div class="desc docblock-short">Provides the functionality for pointwise ReLU operations (overwrites the input
with the result of the operation).</div></li></ul></section></div></main></body></html>