<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Provides a Coaster Plugin, to extend Coaster with Neural Network related operations such as convolutions, pooling, ReLU, etc. A full list of operations provided by this Plugin, can be found at the provided Operations section."><meta name="keywords" content="rust, rustlang, rust-lang, coaster_nn"><title>coaster_nn - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../coaster_nn/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../coaster_nn/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate coaster_nn</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.5.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul></div><section><div class="block"><ul><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../coaster_nn/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><div id="settings-menu" tabindex="-1">
                                <a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div>
                        </div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">coaster_nn</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/coaster_nn/lib.rs.html#1-132">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Provides a <a href="https://github.com/spearow/coaster">Coaster</a> Plugin, to extend Coaster with Neural Network related
operations such as convolutions, pooling, ReLU, etc. A full list of operations provided by this Plugin,
can be found at the <a href="#operations">provided Operations section</a>.</p>
<h3 id="overview"><a href="#overview">Overview</a></h3>
<p>This Coaster Plugin extends Coaster’s Backend with NN related methods/operations. This allows
you to run these operations (and therefore your application) on your local machine as well as on servers,
mobiles or any other machine (as if they were written for common CPU execution), while
receiving the significant performance increases (usually one-to-two orders of magnitutde), by
executing the operations on special purpose hardware such as GPUs - if they are available. Usage examples
can be found in the next section.</p>
<p>The architecture of a Plugin is quite easy. It defines one Plugin Trait, in this case the <code>NN</code>
trait, which implements basic functionality for initialization and multiple Plugin Operation Traits which define the
methods which are going to be available on the Backend, as the Plugin Trait as well as the Plugin Operations Traits
are implemented for the Coaster Backends (CUDA, OpenCL, Native). The operations take as arguments one or many
SharedTensors, holding the data over which the operation should happen, and none or one Operation Configuration.</p>
<h3 id="usage"><a href="#usage">Usage</a></h3>
<p>An example on how to write some data into a SharedTensor and compute the result of the
sigmoid function for each value:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">extern</span> <span class="kw">crate</span> <span class="ident">coaster</span> <span class="kw">as</span> <span class="ident">co</span>;
<span class="kw">extern</span> <span class="kw">crate</span> <span class="ident">coaster_nn</span> <span class="kw">as</span> <span class="ident">nn</span>;
<span class="kw">use</span> <span class="ident">co::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">co::frameworks::native::flatbox::FlatBox</span>;
<span class="kw">use</span> <span class="ident">nn</span>::<span class="kw-2">*</span>;

<span class="kw">fn</span> <span class="ident">write_to_memory</span><span class="op">&lt;</span><span class="ident">T</span>: <span class="ident">Copy</span><span class="op">&gt;</span>(<span class="ident">mem</span>: <span class="kw-2">&amp;mut</span> <span class="ident">FlatBox</span>, <span class="ident">data</span>: <span class="kw-2">&amp;</span>[<span class="ident">T</span>]) {
    <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">mem_buffer</span> <span class="op">=</span> <span class="ident">mem</span>.<span class="ident">as_mut_slice</span>::<span class="op">&lt;</span><span class="ident">T</span><span class="op">&gt;</span>();
    <span class="kw">for</span> (<span class="ident">index</span>, <span class="ident">datum</span>) <span class="kw">in</span> <span class="ident">data</span>.<span class="ident">iter</span>().<span class="ident">enumerate</span>() {
        <span class="ident">mem_buffer</span>[<span class="ident">index</span>] <span class="op">=</span> <span class="kw-2">*</span><span class="ident">datum</span>;
    }
}

<span class="kw">use</span> <span class="ident"><span class="kw">crate</span>::co::frameworks::cuda::get_cuda_backend</span>;
<span class="kw">pub</span> <span class="kw">fn</span> <span class="ident">main</span>() {
    <span class="comment">// Initialize a CUDA Backend.</span>
    <span class="comment">// Usually you would not use CUDA but let Coaster pick what is available on the machine.</span>
    <span class="kw">let</span> <span class="ident">backend</span> <span class="op">=</span> <span class="ident">get_cuda_backend</span>();

    <span class="comment">// Initialize two SharedTensors.</span>
    <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">x</span> <span class="op">=</span> <span class="ident">SharedTensor</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span><span class="ident">::new</span>(<span class="kw-2">&amp;</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>));
    <span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">result</span> <span class="op">=</span> <span class="ident">SharedTensor</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span><span class="ident">::new</span>(<span class="kw-2">&amp;</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>));
    <span class="comment">// Fill `x` with some data.</span>
    <span class="kw">let</span> <span class="ident">payload</span>: <span class="kw-2">&amp;</span>[<span class="ident">f32</span>] <span class="op">=</span> <span class="kw-2">&amp;</span><span class="ident">::std::iter::repeat</span>(<span class="number">1f32</span>).<span class="ident">take</span>(<span class="ident">x</span>.<span class="ident">capacity</span>()).<span class="ident">collect</span>::<span class="op">&lt;</span><span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span><span class="op">&gt;</span>();
    <span class="kw">let</span> <span class="ident">native</span> <span class="op">=</span> <span class="ident">Native::new</span>();
    <span class="kw">let</span> <span class="ident">cpu</span> <span class="op">=</span> <span class="ident">native</span>.<span class="ident">new_device</span>(<span class="ident">native</span>.<span class="ident">hardwares</span>()).<span class="ident">unwrap</span>();
    <span class="ident">write_to_memory</span>(<span class="ident">x</span>.<span class="ident">write_only</span>(<span class="kw-2">&amp;</span><span class="ident">cpu</span>).<span class="ident">unwrap</span>(), <span class="ident">payload</span>); <span class="comment">// Write to native host memory.</span>
    <span class="comment">// Run the sigmoid operation, provided by the NN Plugin, on your CUDA enabled GPU.</span>
    <span class="ident">backend</span>.<span class="ident">sigmoid</span>(<span class="kw-2">&amp;mut</span> <span class="ident">x</span>, <span class="kw-2">&amp;mut</span> <span class="ident">result</span>).<span class="ident">unwrap</span>();
    <span class="comment">// See the result.</span>
    <span class="macro">println!</span>(<span class="string">&quot;{:?}&quot;</span>, <span class="ident">result</span>.<span class="ident">read</span>(<span class="kw-2">&amp;</span><span class="ident">cpu</span>).<span class="ident">unwrap</span>().<span class="ident">as_slice</span>::<span class="op">&lt;</span><span class="ident">f32</span><span class="op">&gt;</span>());
}</code></pre></div>
<h3 id="provided-operations"><a href="#provided-operations">Provided Operations</a></h3>
<p>This Plugins provides the following operations. If not denoted otherwise, this means forward and backward.
A <code>-</code> means not yet implemented.</p>
<div><table><thead><tr><th>Operation</th><th>CUDA</th><th>OpenCL</th><th>Native</th></tr></thead><tbody>
<tr><td>Sigmoid</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>SigmoidPointwise</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>ReLU</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>ReLUPointwise</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>Tanh</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>TanhPointwise</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Normalization (LRN)</td><td>cuDNN v5 or later</td><td>-</td><td>-</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Dropout</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Convolution</td><td>cuDNN v5 or later</td><td>-</td><td>Rust(fwd)</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Softmax</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td>LogSoftmax</td><td>cuDNN v5 or later</td><td>-</td><td>Rust</td></tr>
<tr><td></td><td></td><td></td><td></td></tr>
<tr><td>Pooling Max</td><td>cuDNN v5 or later</td><td>-</td><td>Rust(fwd)</td></tr>
<tr><td>Pooling Avg</td><td>cuDNN v5 or later</td><td>-</td><td>-</td></tr>
</tbody></table>
</div></div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="frameworks/index.html" title="coaster_nn::frameworks mod">frameworks</a></div><div class="item-right docblock-short"><p>Provides the specific Framework implementations for the Library Operations.</p>
</div></div></div><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.impl_ops_log_softmax_for.html" title="coaster_nn::impl_ops_log_softmax_for macro">impl_ops_log_softmax_for</a></div><div class="item-right docblock-short"><p>log softmax impl generation macro</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.impl_ops_lrn_for.html" title="coaster_nn::impl_ops_lrn_for macro">impl_ops_lrn_for</a></div><div class="item-right docblock-short"><p>lrn impl generation macro
TODO it’s all unimplemented!() right now</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.impl_ops_relu_for.html" title="coaster_nn::impl_ops_relu_for macro">impl_ops_relu_for</a></div><div class="item-right docblock-short"><p>relu impl generation macro</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.impl_ops_sigmoid_for.html" title="coaster_nn::impl_ops_sigmoid_for macro">impl_ops_sigmoid_for</a></div><div class="item-right docblock-short"><p>sigmoid impl generation macro</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.impl_ops_softmax_for.html" title="coaster_nn::impl_ops_softmax_for macro">impl_ops_softmax_for</a></div><div class="item-right docblock-short"><p>softmax impl generation macro</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.impl_ops_tanh_for.html" title="coaster_nn::impl_ops_tanh_for macro">impl_ops_tanh_for</a></div><div class="item-right docblock-short"><p>tanh impl generation macro</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.ConvBackwardDataAlgo.html" title="coaster_nn::ConvBackwardDataAlgo enum">ConvBackwardDataAlgo</a></div><div class="item-right docblock-short"><p>Different algorithms to compute the gradient with respect to the filter.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.ConvBackwardFilterAlgo.html" title="coaster_nn::ConvBackwardFilterAlgo enum">ConvBackwardFilterAlgo</a></div><div class="item-right docblock-short"><p>Different algorithms to compute the gradient with respect to the filter.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.ConvForwardAlgo.html" title="coaster_nn::ConvForwardAlgo enum">ConvForwardAlgo</a></div><div class="item-right docblock-short"><p>Different algorithms to compute the convolution forward algorithm.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.DirectionMode.html" title="coaster_nn::DirectionMode enum">DirectionMode</a></div><div class="item-right docblock-short"><p>Direction Mode for RNN [cudnnDirectionMode_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnDirectionMode_t</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.MathType.html" title="coaster_nn::MathType enum">MathType</a></div><div class="item-right docblock-short"><p>Indicate if Tensor Core Operations are permitted [cudnnMathType_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnMathType_t</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.RnnAlgorithm.html" title="coaster_nn::RnnAlgorithm enum">RnnAlgorithm</a></div><div class="item-right docblock-short"><p>Algorithm for RNN [cudnnRNNAlgo_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnRNNAlgo_t</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.RnnInputMode.html" title="coaster_nn::RnnInputMode enum">RnnInputMode</a></div><div class="item-right docblock-short"><p>Input Modes for RNN [cudnnRNNInputMode_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnRNNInputMode_t</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.RnnNetworkMode.html" title="coaster_nn::RnnNetworkMode enum">RnnNetworkMode</a></div><div class="item-right docblock-short"><p>Network Type for RNN Networks [cudnnRNNMOde_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnRNNMode_t</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.RnnPaddingMode.html" title="coaster_nn::RnnPaddingMode enum">RnnPaddingMode</a></div><div class="item-right docblock-short"><p>Enables/Disables the padded input/output [cudnnRNNPaddingMode_t][1]
[1]: https://docs.nvidia.com/deeplearning/sdk/cudnn-api/index.html#cudnnRNNPaddingMode_t</p>
</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Convolution.html" title="coaster_nn::Convolution trait">Convolution</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support Convolution operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.ConvolutionConfig.html" title="coaster_nn::ConvolutionConfig trait">ConvolutionConfig</a></div><div class="item-right docblock-short"><p>Provides Convolution Config functionality.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Dropout.html" title="coaster_nn::Dropout trait">Dropout</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support Dropout operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.LRN.html" title="coaster_nn::LRN trait">LRN</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support Local Response Normalization operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.LogSoftmax.html" title="coaster_nn::LogSoftmax trait">LogSoftmax</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support LogSoftmax operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.NN.html" title="coaster_nn::NN trait">NN</a></div><div class="item-right docblock-short"><p>Provides the functionality for a backend to support Neural Network related operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.NNOperationConfig.html" title="coaster_nn::NNOperationConfig trait">NNOperationConfig</a></div><div class="item-right docblock-short"><p>Provides generic NN Operation Config functionality.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Pooling.html" title="coaster_nn::Pooling trait">Pooling</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support Pooling operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Relu.html" title="coaster_nn::Relu trait">Relu</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support ReLU operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.ReluPointwise.html" title="coaster_nn::ReluPointwise trait">ReluPointwise</a></div><div class="item-right docblock-short"><p>Provides the functionality for pointwise ReLU operations (overwrites the input with the result of the operation).</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Rnn.html" title="coaster_nn::Rnn trait">Rnn</a></div><div class="item-right docblock-short"><p>Provide the functionality for a Backend to support RNN operations</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.RnnConfig.html" title="coaster_nn::RnnConfig trait">RnnConfig</a></div><div class="item-right docblock-short"><p>Provides Rnn Config functionality.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Sigmoid.html" title="coaster_nn::Sigmoid trait">Sigmoid</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support Sigmoid operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.SigmoidPointwise.html" title="coaster_nn::SigmoidPointwise trait">SigmoidPointwise</a></div><div class="item-right docblock-short"><p>Provides the functionality for pointwise Sigmoid operations (overwrites the input with the result of the operation).</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Softmax.html" title="coaster_nn::Softmax trait">Softmax</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support Softmax operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Tanh.html" title="coaster_nn::Tanh trait">Tanh</a></div><div class="item-right docblock-short"><p>Provides the functionality for a Backend to support TanH operations.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.TanhPointwise.html" title="coaster_nn::TanhPointwise trait">TanhPointwise</a></div><div class="item-right docblock-short"><p>Provides the functionality for pointwise ReLU operations (overwrites the input
with the result of the operation).</p>
</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="coaster_nn" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.63.0 (4b91a6ea7 2022-08-08)" ></div>
</body></html>